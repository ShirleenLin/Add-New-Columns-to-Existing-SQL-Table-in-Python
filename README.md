When I had almost got the result, I realized I hadnâ€™t included company revenues. 
So this is what I wrote to download new attributes and add them as columns to an existing SQL table.

This method with Breakpoint Recovery works better for large datasets - it saves data to SQL every iteration

For smaller datasets, you can simply save each iteration in one big DataFrame - it'd be faster
